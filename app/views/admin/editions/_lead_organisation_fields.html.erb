<%= form.fields_for :lead_edition_organisations, edition_organisation do |edition_organisation_form| %>
  <%= render("components/select_with_search", {
    id: "edition_lead_edition_organisations_attributes_#{index}_organisation_id",
    label: "Select lead organisation #{index + 1}",
    heading_size: "s",
    include_blank: true,
    name: "edition[lead_edition_organisations_attributes][#{index}][organisation_id]",
    options: taggable_organisations_container.map do |name, id|
      {
        text: name,
        value: id,
        selected: id == edition_organisation_form.object.organisation_id,
      }
    end
  }) %>
  <% if edition_organisation_form.object.id.present? %>
    <%= edition_organisation_form.hidden_field :id, value: edition_organisation_form.object.id %>
  <% end %>
  <%= edition_organisation_form.hidden_field :edition_id, value: edition_organisation_form.object.edition_id %>
  <%= edition_organisation_form.hidden_field :lead_ordering, value: index %>
<% end %>