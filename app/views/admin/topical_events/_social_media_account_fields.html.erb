<%= form.fields_for :social_media_accounts, social_media_account do |social_media_form| %>
  <%= render "govuk_publishing_components/components/select", {
    id: "topical_event_social_media_accounts_attributes_#{index}_social_media_service_id",
    label: "Service (required)",
    name: "topical_event[social_media_accounts_attributes][#{index}][social_media_service_id]",
    heading_size: "s",
      options: ConfigurableDocumentType.find("topical_event").form.dig("fields", "social_media_links", "fields", "social_media_service_id", "options").map do |option|
        {
          text: option["label"],
          value: option["value"],
          selected: social_media_form.object.social_media_service_id == option["value"],
        }
      end,
    full_width: true,
    error_items: errors_for(social_media_form.object.errors, :social_media_service_id),
  } %>
  <%= render "govuk_publishing_components/components/input", {
    label: {
      text: "URL (required)",
    },
    name: "topical_event[social_media_accounts_attributes][#{index}][url]",
    id: "topical_event_social_media_accounts_attributes_#{index}_url",
    value: social_media_form.object.url,
    heading_size: "s",
    error_items: errors_for(social_media_form.object.errors, :url),
  } %>
<% end %>
