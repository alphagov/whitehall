<% if !render_card? %>
  <li class="govuk-grid-row">
    <div class="govuk-grid-column-one-third">
      <% if image.image_data&.original_uploaded? && image.thumbnail %>
        <img src="<%= image.thumbnail %>" alt="" class="app-view-edition-resource__preview">
      <% else %>
        <span class="govuk-tag govuk-tag--green">Processing</span>
      <% end %>
    </div>

    <div class="govuk-grid-column-two-thirds">
      <p class="govuk-body"><strong>Caption: </strong><%= caption %></p>
      <% if image.image_data&.bitmap? && image.image_data&.requires_crop? %>
        <span class="govuk-tag govuk-tag--red">Requires crop</span>
      <% end %>
      <% if image_usage.embeddable? %>
        <%= render "govuk_publishing_components/components/copy_to_clipboard", {
          label: tag.strong("Markdown code:"),
          copyable_content: image_markdown,
          button_text: "Copy Markdown",
        } %>
      <% end %>
    </div>

    <div class="app-view-edition-resource__actions govuk-grid-column-full govuk-button-group govuk-!-margin-top-4">
      <%= link_to("Edit details", edit_admin_edition_image_path(edition, image), class: "govuk-link govuk-!-margin-top-2 app-view-edition-resource__actions__link") %>
      <%= link_to("Delete image", confirm_destroy_admin_edition_image_path(edition, image), class: "govuk-link gem-link--destructive govuk-!-margin-top-2 app-view-edition-resource__actions__link") %>

      <% if can_be_custom_lead_image? %>
        <%= form_with url: admin_edition_lead_image_path(edition, image), method: :patch do |form| %>
          <%= render "govuk_publishing_components/components/button", {
            text: "Select as lead image",
            secondary_solid: true,
            margin_bottom: 4,
          } %>
        <% end %>
      <% end %>
    </div>
  </li>
<% else %>
  <%= render "govuk_publishing_components/components/summary_card", {
    title: image_usage.kinds.first.display_name,
    summary_card_actions: image.present? ? [
      {
        label: "Edit",
        href: edit_admin_edition_image_path(edition, image),
        destructive: false
      },
      {
        label: "Delete",
        href: confirm_destroy_admin_edition_image_path(edition, image),
        destructive: true
      }
    ] : [
      {
        label: "Add",
        href: new_admin_edition_image_path(edition_id: edition.id, image_usage: image_usage.key),
      }
    ],
    rows: [
      {
        key: "Image",
        value: image ? (image.image_data&.original_uploaded? && image.thumbnail ? (image.requires_crop? ? "<span class=\"govuk-tag govuk-tag--red\">Requires cropping</span>".html_safe : "<img style=\"width: 100%;\" src=\"#{image.thumbnail}\" alt="" class=\"app-view-edition-resource__preview\">".html_safe) : "<span class=\"govuk-tag govuk-tag--green\">Processing</span>".html_safe) : "Not set"
      },
      {
        key: "Caption",
        value: image ? image.caption : "Not set"
      }
    ]
  } %>
<% end %>