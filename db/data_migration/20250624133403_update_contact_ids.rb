# Query finding the known 'bad' contacts from an old backup, and plucking their key information:
#
# ```
# old_contacts = Contact.where(id: [263,266,267,268,269,272,277,278,282,285,292,296,303,305,307,311,312,313,318,319,320,326,328,329,330,331,332,334,335,338,345,346,347,349,352,364,366,370,372,373,374,377,-378,385,398,405,412,416,417,418,419,433,435,436,440,443,444,446,453,454,455,460,465,467,470,471,474,476,477,482,488,496,497,498,500,524,543,549,564,573,577,595,596,602,603,605,614,620,637,647,650,662,664,698,707,709,710,732,733,741,753,759,804,817,834,835,836,868,877,897,959,977,1029,1032,1033,1035,1036,1108,1117,1120,1143,1162,1174,1175,1251,1313,1356,1365,1376,1388,1458,1503,1509,1530,1542,1855,1884,1905,1906,1937,1957,1974,2163,2199,2225,2290,2305,2326,2419,2425,2445,2474,2484,2555,2558,2666,2768,2772,2773,2817,2842,2845,2923,2931,2970,3053,3061,3130,3167,3186,3188,3198,3206,3255,3340,3355,3361,3704,3805,3810,3813,3821,3837,3929,4026,4350]).pluck(:id, :contactable_type, :contactable_id, :title, :country_id, :street_address)
# ```
#
# Result:
#
# ```
#  [
#    [263, "WorldwideOffice", 4, "British High Commission Port of Spain", 140, "19 St Clair AvenueSt Clair,"],
#    [266, "WorldwideOffice", 5, "British Embassy Lima", 108, "Torre Parque Mar (22nd Floor)Avenida Jos<C3><A9> Larco 1301Miraflores"],
#    ...and so on
#  ]
# ```
#
# We then mapped these old contacts to new ones on production, using this quick and dirty script:
#
# ```
# contact_mapping = old_contacts.map do |old_contact|
#   exact_matches = Contact.where(title: old_contact[3], street_address: old_contact[5])
#   fuzzy_matches = Contact.where(title: old_contact[3])
#   match = exact_matches.count.positive? ? exact_matches.first : (fuzzy_matches.count.positive? ? fuzzy_matches.first : nil)
#   { old_contact_id: old_contact[0], new_contact_id: match&.id, confidence: exact_matches.count.positive? ? "exact match" : (fuzzy_matches.count.positive? ? "fuzzy match" : "N/A"), details: match ? "old contact (title '#{old_contact[3]}', street address: '#{old_contact[5]}'). new contact (title '#{match.title}', street address: '#{match.street_address}')" : "N/A" }
# end
# ```
#
# I then looked at the four N/A matches and manually found two of them - see "manually mapped" in the output below to see which ones.
# The remaining two (Organisation ones) could not be mapped - I've left them in the output below but commented out.

contact_mapping = [{ old_contact_id: 263,
                     new_contact_id: 4407,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Port of Spain', street address: '19 St Clair AvenueSt Clair,'). new contact (title 'British High Commission Port of Spain', street address: '19 St Clair AvenueSt Clair,')" },
                   { old_contact_id: 266,
                     new_contact_id: 4410,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Lima', street address: 'Torre Parque Mar (22nd Floor)Avenida Jos<C3><A9> Larco 1301Miraflores'). new contact (title 'British Embassy Lima', street address: 'Torre Parque Mar (22nd Floor)Avenida Jos<C3><A9> Larco 1301Miraflores')" },
                   { old_contact_id: 267,
                     new_contact_id: 4414,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Kingston', street address: 'British High Commission P O Box 57528 Trafalgar Road Kingston 10'). new contact (title 'British High Commission Kingston', street address: 'British High Commission P O Box 57528 Trafalgar Road Kingston 10')" },
                   { old_contact_id: 268,
                     new_contact_id: 4416,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Guatemala City (for Honduras)', street address: 'Edificio Torre Internacional, \r\nNivel 11, 16 Calle 0-55, \r\nZona 10 Guatemala City'). new contact (title 'British Embassy Guatemala City (for Honduras)', street address: 'Edificio Torre Internacional, Nivel 11, 16 Calle 0-55, Zona 10 Guatemala City')" },
                   { old_contact_id: 269,
                     new_contact_id: 4417,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Guatemala City', street address: 'Edificio Torre Internacional, Nivel 11, 16 Calle 0-55, Zona 10 Guatemala City '). new contact (title 'British Embassy Guatemala City', street address: 'Edificio Torre Internacional, Nivel 11, 16 Calle 0-55, Zona 10 Guatemala City ')" },
                   { old_contact_id: 272,
                     new_contact_id: 4427,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy', street address: 'Edificio Centro Col<C3><B3>n, Paseo Col<C3><B3>n and Streets 38 and 40'). new contact (title 'British Embassy', street address: 'Edificio Centro Col<C3><B3>n, Paseo Col<C3><B3>n and Streets 38 and 40')" },
                   { old_contact_id: 277,
                     new_contact_id: 4431,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Santiago', street address: 'Avda. El Bosque Norte 0125Las Condes, '). new contact (title 'British Embassy Santiago', street address: 'Avda. El Bosque Norte 0125Las Condes, ')" },
                   { old_contact_id: 278,
                     new_contact_id: 4438,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Brasilia', street address: 'Quadra 801 - Conjunto K - Lote 08Av. das Na<C3><A7><C3><B5>es - Asa Sul'). new contact (title 'British Embassy Brasilia', street address: 'Quadra 801 - Conjunto K - Lote 08Av. das Na<C3><A7><C3><B5>es - Asa Sul')" },
                   { old_contact_id: 282,
                     new_contact_id: 4450,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy, La Paz', street address: 'Avenida Arce No. 2732'). new contact (title 'British Embassy, La Paz', street address: 'Avenida Arce No. 2732')" },
                   { old_contact_id: 285,
                     new_contact_id: 4453,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission, Bridgetown', street address: 'Lower Collymore RockPO Box 676'). new contact (title 'British High Commission, Bridgetown', street address: 'Lower Collymore RockPO Box 676')" },
                   { old_contact_id: 292,
                     new_contact_id: 4474,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Luxembourg', street address: '5, Boulevard Joseph II'). new contact (title 'British Embassy Luxembourg', street address: '5, Boulevard Joseph II')" },
                   { old_contact_id: 296,
                     new_contact_id: 4477,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Skopje', street address: 'Todor Aleksandrov No.165'). new contact (title 'British Embassy Skopje', street address: 'Todor Aleksandrov No.165')" },
                   { old_contact_id: 303,
                     new_contact_id: 4480,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy (Consular Services)', street address: '39a, Hamdije Cemerlica street'). new contact (title 'British Embassy (Consular Services)', street address: '39a, Hamdije Cemerlica street')" },
                   { old_contact_id: 305,
                     new_contact_id: 4484,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Minsk', street address: '37, Karl Marx Street'). new contact (title 'British Embassy Minsk', street address: '37, Karl Marx Street')" },
                   { old_contact_id: 307,
                     new_contact_id: 4497,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Sofia', street address: '9, Moskovska St'). new contact (title 'British Embassy Sofia', street address: '9, Moskovska St')" },
                   { old_contact_id: 311,
                     new_contact_id: 4500,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Nicosia', street address: 'Alexander Pallis StreetPO Box 21978'). new contact (title 'British High Commission Nicosia', street address: 'Alexander Pallis StreetPO Box 21978')" },
                   { old_contact_id: 312,
                     new_contact_id: 4464,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Yerevan', street address: '8th Floor, Kamar Business Centre, 2 Vazgen Sargsyan Street'). new contact (title 'British Embassy Yerevan', street address: '8th Floor, Kamar Business Centre, 2 Vazgen Sargsyan Street')" },
                   { old_contact_id: 313,
                     new_contact_id: 4486,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Prague', street address: 'Thunovska 14'). new contact (title 'British Embassy Prague', street address: 'Thunovska 14')" },
                   { old_contact_id: 318,
                     new_contact_id: 4502,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Copenhagen', street address: 'Kastelsvej 36-40'). new contact (title 'British Embassy Copenhagen', street address: 'Kastelsvej 36-40')" },
                   { old_contact_id: 319,
                     new_contact_id: 4503,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Tallinn', street address: 'Wismari 6'). new contact (title 'British Embassy Tallinn', street address: 'Wismari 6')" },
                   { old_contact_id: 320,
                     new_contact_id: 4505,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Helsinki', street address: 'It<C3><A4>inen Puistotie 17'). new contact (title 'British Embassy Helsinki', street address: 'It<C3><A4>inen Puistotie 17')" },
                   { old_contact_id: 326,
                     new_contact_id: 4507,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Tbilisi', street address: '51 Krtsanisi Street'). new contact (title 'British Embassy Tbilisi', street address: '51 Krtsanisi Street')" },
                   { old_contact_id: 328,
                     new_contact_id: 4510,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Budapest', street address: 'F<C3><BC>ge utca 5-7'). new contact (title 'British Embassy Budapest', street address: 'F<C3><BC>ge utca 5-7')" },
                   { old_contact_id: 329,
                     new_contact_id: 4511,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Reykjavik', street address: 'Lauf<C3><A1>svegur 31'). new contact (title 'British Embassy Reykjavik', street address: 'Lauf<C3><A1>svegur 31')" },
                   { old_contact_id: 330,
                     new_contact_id: 4512,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Dublin', street address: '29 Merrion Road\r\nBallsbridge'). new contact (title 'British Embassy Dublin', street address: '29 Merrion Road Ballsbridge')" },
                   { old_contact_id: 331,
                     new_contact_id: 4513,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Tirana', street address: 'Rruga Skenderbeg 12'). new contact (title 'British Embassy Tirana', street address: 'Rruga Skenderbeg 12')" },
                   { old_contact_id: 332,
                     new_contact_id: 4555,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Pristina', street address: 'Lidhja e Pejes 177'). new contact (title 'British Embassy Pristina', street address: 'Lidhja e Pejes 177')" },
                   { old_contact_id: 334,
                     new_contact_id: 4562,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Riga', street address: '5, J.Alunana iela'). new contact (title 'British Embassy Riga', street address: '5, J.Alunana iela')" },
                   { old_contact_id: 335,
                     new_contact_id: 4494,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy The Hague', street address: 'Lange Voorhout 10'). new contact (title 'British Embassy The Hague', street address: 'Lange Voorhout 10')" },
                   { old_contact_id: 338,
                     new_contact_id: 4514,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Rome', street address: 'Via XX Settembre 80/a'). new contact (title 'British Embassy Rome', street address: 'Via XX Settembre 80/a')" },
                   { old_contact_id: 345,
                     new_contact_id: 4495,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Oslo', street address: 'Visiting address: Thomas Heftyes Gate 8; Postal address: Postboks 4005 AMB'). new contact (title 'British Embassy Oslo', street address: 'Visiting address: Thomas Heftyes Gate 8; Postal address: Postboks 4005 AMB')" },
                   { old_contact_id: 346,
                     new_contact_id: 4490,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British High Commission Malta', street address: 'Whitehall Mansions, Ta<E2><80><99> Xbiex Seafront\r\n'). new contact (title 'British High Commission Malta', street address: 'Whitehall Mansions, Ta<E2><80><99> Xbiex Seafront')" },
                   { old_contact_id: 347,
                     new_contact_id: 4496,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Warsaw', street address: 'ul. Kawalerii 12'). new contact (title 'British Embassy Warsaw', street address: 'ul. Kawalerii 12')" },
                   { old_contact_id: 349,
                     new_contact_id: 4519,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Consulate Lisbon', street address: 'Rua de S<C3><A3>o Bernardo 33'). new contact (title 'British Consulate Lisbon', street address: 'Rua de S<C3><A3>o Bernardo 33')" },
                   { old_contact_id: 352,
                     new_contact_id: 4491,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Chisinau', street address: '18 Nicolae Iorga Str.'). new contact (title 'British Embassy Chisinau', street address: '18 Nicolae Iorga Str.')" },
                   { old_contact_id: 364,
                     new_contact_id: 4493,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Podgorica', street address: 'Ulcinjska 8, Gorica C'). new contact (title 'British Embassy Podgorica', street address: 'Ulcinjska 8, Gorica C')" },
                   { old_contact_id: 366,
                     new_contact_id: 4563,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Vilnius', street address: 'Antakalnio str. 2 '). new contact (title 'British Embassy Vilnius', street address: 'Antakalnio str. 2 ')" },
                   { old_contact_id: 370,
                     new_contact_id: 4524,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Bucharest', street address: '24 Jules Michelet'). new contact (title 'British Embassy Bucharest', street address: '24 Jules Michelet')" },
                   { old_contact_id: 372,
                     new_contact_id: 4527,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Bratislava', street address: 'Pansk<C3><A1> 16'). new contact (title 'British Embassy Bratislava', street address: 'Pansk<C3><A1> 16')" },
                   { old_contact_id: 373,
                     new_contact_id: 4528,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Ljubljana', street address: 'Trg republike 3'). new contact (title 'British Embassy Ljubljana', street address: 'Trg republike 3')" },
                   { old_contact_id: 374,
                     new_contact_id: 4533,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Stockholm', street address: 'Skarp<C3><B6>gatan 6-8Box 27819'). new contact (title 'British Embassy Stockholm', street address: 'Skarp<C3><B6>gatan 6-8Box 27819')" },
                   { old_contact_id: 377,
                     new_contact_id: 4541,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Berne', street address: 'Thunstrasse 50'). new contact (title 'British Embassy Berne', street address: 'Thunstrasse 50')" },
                   { old_contact_id: 385,
                     new_contact_id: 4545,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Kyiv', street address: ''). new contact (title 'British Embassy Kyiv', street address: '')" },
                   { old_contact_id: 398,
                     new_contact_id: 4566,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Manama, main contact', street address: '21 Government AvenueManama 306'). new contact (title 'British Embassy Manama, main contact', street address: '21 Government AvenueManama 306')" },
                   { old_contact_id: 405,
                     new_contact_id: 4419,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Dushanbe', street address: '65 Mirzo Tursunzoda Street'). new contact (title 'British Embassy Dushanbe', street address: '65 Mirzo Tursunzoda Street')" },
                   { old_contact_id: 416,
                     new_contact_id: 4576,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Ashgabat', street address: '3rd Floor Office Building Four Points Ak Altyn Hotel '). new contact (title 'British Embassy Ashgabat', street address: '3rd Floor Office Building Four Points Ak Altyn Hotel ')" },
                   { old_contact_id: 417,
                     new_contact_id: 4421,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Tashkent', street address: '67, Gulyamov Street'). new contact (title 'British Embassy Tashkent', street address: '67, Gulyamov Street')" },
                   { old_contact_id: 418,
                     new_contact_id: 4578,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British High Commission Belmopan', street address: 'North Ring Road/Melhado Parade(Entrance via North Ring Road)PO Box 91'). new contact (title 'British High Commission Belmopan', street address: 'PO Box 91')" },
                   { old_contact_id: 419,
                     new_contact_id: 4583,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British High Commission Nairobi', street address: 'Upper Hill Road\r\nP.O. Box 30465-00100, Nairobi'). new contact (title 'British High Commission Nairobi', street address: 'Upper Hill RoadP.O. Box 30465-00100, Nairobi')" },
                   { old_contact_id: 433,
                     new_contact_id: 4585,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Dakar', street address: 'BP 6025 Dakar'). new contact (title 'British Embassy Dakar', street address: 'BP 6025 Dakar')" },
                   { old_contact_id: 435,
                     new_contact_id: 4587,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Tel Aviv', street address: '192 Hayarkon Street'). new contact (title 'British Embassy Tel Aviv', street address: '192 Hayarkon Street')" },
                   { old_contact_id: 436,
                     new_contact_id: 4591,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Accra', street address: 'Julius Nyerere Link, off Gamel Abdul Nasser AvenuePO Box 296'). new contact (title 'British High Commission Accra', street address: 'Julius Nyerere Link, off Gamel Abdul Nasser AvenuePO Box 296')" },
                   { old_contact_id: 440,
                     new_contact_id: 4598,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Kuwait, main contact', street address: 'Arabian Gulf Street\r\nDasman\r\n'). new contact (title 'British Embassy Kuwait, main contact', street address: 'Arabian Gulf StreetDasman')" },
                   { old_contact_id: 443,
                     new_contact_id: 4602,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy', street address: 'Serail Hill, Embassy Complex Beirut Central District'). new contact (title 'British Embassy', street address: 'Serail Hill, Embassy Complex Beirut Central District')" },
                   { old_contact_id: 444,
                     new_contact_id: 4604,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Yaounde', street address: 'Avenue Winston Churchill'). new contact (title 'British High Commission Yaounde', street address: 'Avenue Winston Churchill')" },
                   { old_contact_id: 446,
                     new_contact_id: 4610,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Freetown', street address: '6 Spur Road Freetown'). new contact (title 'British High Commission Freetown', street address: '6 Spur Road Freetown')" },
                   { old_contact_id: 453,
                     new_contact_id: 4617,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Asmara', street address: '66-68 Mariam Ghimbi Street\r\nZip Code 174\r\nPO Box 5584'). new contact (title 'British Embassy Asmara', street address: '66-68 Mariam Ghimbi StreetZip Code 174PO Box 5584')" },
                   { old_contact_id: 454,
                     new_contact_id: 4618,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Maputo', street address: 'Avenida Vladmir Lenine, 310'). new contact (title 'British High Commission Maputo', street address: 'Avenida Vladmir Lenine, 310')" },
                   { old_contact_id: 455,
                     new_contact_id: 5089,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Cairo', street address: '7 Ahmed Ragheb Street\r\nGarden City'). new contact (title 'British Embassy Cairo', street address: '7 Ahmed Ragheb Street\r\nGarden City')" },
                   { old_contact_id: 460,
                     new_contact_id: 4627,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Addis Ababa', street address: 'Comoros Street'). new contact (title 'British Embassy Addis Ababa', street address: 'Comoros Street')" },
                   { old_contact_id: 465,
                     new_contact_id: 4634,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Baku', street address: '45 Khagani StreetAZ1010'). new contact (title 'British Embassy Baku', street address: '45 Khagani StreetAZ1010')" },
                   { old_contact_id: 467,
                     new_contact_id: 4637,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Windhoek', street address: '116 Robert Mugabe Ave, P.O. Box 22202'). new contact (title 'British High Commission Windhoek', street address: '116 Robert Mugabe Ave, P.O. Box 22202')" },
                   { old_contact_id: 470,
                     new_contact_id: 4638,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British High Commission Gaborone', street address: 'Plot 1079-1084Main Malloff Queens Road '). new contact (title 'British High Commission Gaborone', street address: 'Plot 1079-1084 Main Malloff Queens Road ')" },
                   { old_contact_id: 471,
                     new_contact_id: 4639,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Banjul', street address: '48 Atlantic RoadFajaraPO Box 507Banjul'). new contact (title 'British High Commission Banjul', street address: '48 Atlantic RoadFajaraPO Box 507Banjul')" },
                   { old_contact_id: 474,
                     new_contact_id: 4643,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Abu Dhabi, main contact', street address: 'Al Hisn Street, Al Markaziyah West '). new contact (title 'British Embassy Abu Dhabi, main contact', street address: 'Al Hisn Street, Al Markaziyah West ')" },
                   { old_contact_id: 476,
                     new_contact_id: 4647,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Mogadishu', street address: 'Mogadishu'). new contact (title 'British Embassy Mogadishu', street address: 'Mogadishu')" },
                   { old_contact_id: 477,
                     new_contact_id: 4648,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Luanda', street address: 'Rua 17 de Setembro, N<C2><BA> 4Caixa Postal 1244'). new contact (title 'British Embassy Luanda', street address: 'Rua 17 de Setembro, N<C2><BA> 4Caixa Postal 1244')" },
                   { old_contact_id: 482,
                     new_contact_id: 4653,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Harare', street address: '3 Norfolk Road, Mount Pleasant, '). new contact (title 'British Embassy Harare', street address: '3 Norfolk Road, Mount Pleasant, ')" },
                   { old_contact_id: 488,
                     new_contact_id: 4656,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Port Louis', street address: 'Sir Hesketh Bell StreetPO Box 2, Floreal, Plaines Wilhems'). new contact (title 'British High Commission Port Louis', street address: 'Sir Hesketh Bell StreetPO Box 2, Floreal, Plaines Wilhems')" },
                   { old_contact_id: 496,
                     new_contact_id: 4661,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Antananarivo', street address: 'Ninth Floor Tour Zital Ravoninahitriniarivo Street'). new contact (title 'British Embassy Antananarivo', street address: 'Ninth Floor Tour Zital Ravoninahitriniarivo Street')" },
                   { old_contact_id: 497,
                     new_contact_id: 4663,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Kinshasa', street address: '83, Avenue Roi Baudouin, Gombe'). new contact (title 'British Embassy Kinshasa', street address: '83, Avenue Roi Baudouin, Gombe')" },
                   { old_contact_id: 498,
                     new_contact_id: 4667,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Lilongwe', street address: 'Off Convention Drive, P.O. Box 30042'). new contact (title 'British High Commission Lilongwe', street address: 'Off Convention Drive, P.O. Box 30042')" },
                   { old_contact_id: 500,
                     new_contact_id: 4669,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Lusaka', street address: '5210 Independence Avenue, P.O. Box 5005015101 Ridgeway'). new contact (title 'British High Commission Lusaka', street address: '5210 Independence Avenue, P.O. Box 5005015101 Ridgeway')" },
                   { old_contact_id: 524,
                     new_contact_id: 4688,
                     confidence: "exact match",
                     details: "old contact (title 'Department for Business and Trade South Korea', street address: 'Sejong-daero 19-gil, 24'). new contact (title 'Department for Business and Trade South Korea', street address: 'Sejong-daero 19-gil, 24')" },
                   { old_contact_id: 543,
                     new_contact_id: 4733,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Consulate General Miami', street address: '1001 Brickell Bay Drive'). new contact (title 'British Consulate General Miami', street address: '1101 Brickell Avenue, Suite N-1900')" },
                   { old_contact_id: 549,
                     new_contact_id: 4746,
                     confidence: "exact match",
                     details: "old contact (title 'Department for Business and Trade USA', street address: '845 Third Avenue'). new contact (title 'Department for Business and Trade USA', street address: '845 Third Avenue')" },
                   { old_contact_id: 564,
                     new_contact_id: 4755,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Kigali', street address: 'KG 7 AveKacyiru-Sud '). new contact (title 'British High Commission Kigali', street address: 'KG 7 AveKacyiru-Sud ')" },
                   { old_contact_id: 573,
                     new_contact_id: 4761,
                     confidence: "exact match",
                     details: "old contact (title 'Department for Business and Trade Kazakhstan', street address: 'Building Business Centre Renko, 6 floor\t\r\n62 Kosmonavtov street'). new contact (title 'Department for Business and Trade Kazakhstan', street address: 'Building Business Centre Renko, 6 floor\t\r\n62 Kosmonavtov street')" },
                   { old_contact_id: 577,
                     new_contact_id: 4766,
                     confidence: "exact match",
                     details: "old contact (title 'Department for Business and Trade Greece', street address: 'Ploutarchou 1'). new contact (title 'Department for Business and Trade Greece', street address: 'Ploutarchou 1')" },
                   { old_contact_id: 595,
                     new_contact_id: 4778,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Montevideo', street address: 'British EmbassyMarco Bruto 1073'). new contact (title 'British Embassy Montevideo', street address: 'British EmbassyMarco Bruto 1073')" },
                   { old_contact_id: 596,
                     new_contact_id: 4781,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Panama City', street address: 'Humboldt Tower, 4th FloorCalle 53, Marbella'). new contact (title 'British Embassy Panama City', street address: 'Humboldt Tower, 4th FloorCalle 53, Marbella')" },
                   { old_contact_id: 602,
                     new_contact_id: 4411,
                     confidence: "fuzzy match",
                     details: "old contact (title 'Consular Section', street address: 'Torre La Castellana, Piso 11.  Av Principal de la Castellana, Urbanizaci<C3><B3>n La Castellana'). new contact (title 'Consular section', street address: 'Torre Parque Mar (23rd Floor) Avenida Jos<C3><A9> Larco, 1301')" },
                   { old_contact_id: 603,
                     new_contact_id: 4782,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Mexico City', street address: 'British EmbassyPaseo de la Reforma 350 20th Floor,Torre del AngelCol. Ju<C3><A1>rez'). new contact (title 'British Embassy Mexico City', street address: 'British EmbassyPaseo de la Reforma 350 20th Floor,Torre del AngelCol. Ju<C3><A1>rez')" },
                   { old_contact_id: 605,
                     new_contact_id: 4784,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Consulate-General Hong Kong', street address: '1 Supreme Court RoadAdmiralty'). new contact (title 'British Consulate-General Hong Kong', street address: '1 Supreme Court Road')" },
                   { old_contact_id: 614,
                     new_contact_id: 4795,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Santo Domingo', street address: 'Av. Winston Churchill 1099 Torre Citigroup, Acropolis, Floor 18, Santo Domingo, Dominican Republic'). new contact (title 'British Embassy Santo Domingo', street address: 'Av. Winston Churchill 1099 Torre Citigroup, Acropolis, Floor 18, Santo Domingo, Dominican Republic')" },
                   { old_contact_id: 620,
                     new_contact_id: 4803,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Port Moresby', street address: 'Sec 411 Lot 1 & 2Kiroki StreetWaiganiNational Capital District'). new contact (title 'British High Commission Port Moresby', street address: 'Sec 411 Lot 1 & 2Kiroki StreetWaiganiNational Capital District')" },
                   { old_contact_id: 637,
                     new_contact_id: 4819,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Athens', street address: '1, Ploutarchou str'). new contact (title 'British Embassy Athens', street address: '1, Ploutarchou str')" },
                   { old_contact_id: 647,
                     new_contact_id: 4831,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Manila', street address: '120 Upper McKinley Road, McKinley HillTaguig City'). new contact (title 'British Embassy Manila', street address: '120 Upper McKinley Road, McKinley HillTaguig City')" },
                   { old_contact_id: 650,
                     new_contact_id: 4837,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Bangkok', street address: 'British Embassy, AIA Sathorn Tower, Floor 12A, 11/1 South Sathorn Road,Sathorn'). new contact (title 'British Embassy Bangkok', street address: 'British Embassy, AIA Sathorn Tower, Floor 12A, 11/1 South Sathorn Road, Sathorn')" },
                   { old_contact_id: 662,
                     new_contact_id: 4851,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Havana', street address: 'Calle 34 no. 702 esq 7ma. Miramar, Playa'). new contact (title 'British Embassy Havana', street address: 'Calle 34 no. 702 esq 7ma. Miramar, Playa')" },
                   { old_contact_id: 664,
                     new_contact_id: 4787,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Kuala Lumpur', street address: 'Level 27 Menara Binjai2 Jalan BinjaiKuala Lumpur50450 '). new contact (title 'British High Commission Kuala Lumpur', street address: 'Level 27 Menara Binjai2 Jalan BinjaiKuala Lumpur50450 ')" },
                   { old_contact_id: 698,
                     new_contact_id: 4868,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Astana', street address: '62 Kosmonavtov Str.Renco Building, 6 Floor'). new contact (title 'British Embassy Astana', street address: '62 Kosmonavtov Str.Renco Building, 6 Floor')" },
                   { old_contact_id: 710,
                     new_contact_id: 4885,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Abidjan', street address: 'Ambassade de Grande-Bretagne, Cocody Quartier Ambassades\r\nImpasse du Belier, Rue A 58, 01 BP 2581 Abidjan 01'). new contact (title 'British Embassy Abidjan', street address: 'Ambassade de Grande-Bretagne, Cocody Quartier AmbassadesImpasse du Belier, Rue A 58, 01 BP 2581 Abidjan 01')" },
                   { old_contact_id: 732,
                     new_contact_id: 4886,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Georgetown', street address: '44 Main Street'). new contact (title 'British High Commission Georgetown', street address: '44 Main Street')" },
                   { old_contact_id: 733,
                     new_contact_id: 4887,
                     confidence: "exact match",
                     details: "old contact (title 'Honorary British Consul Suriname', street address: '44 Main street\r\nGeorgetown\r\n'). new contact (title 'Honorary British Consul Suriname', street address: '44 Main street\r\nGeorgetown\r\n')" },
                   { old_contact_id: 741,
                     new_contact_id: 4875,
                     confidence: "exact match",
                     details: "old contact (title 'The Consular Section of the British Embassy Beijing', street address: '11 Guang Hua Lu, Jian Guo Men Wai '). new contact (title 'The Consular Section of the British Embassy Beijing', street address: '11 Guang Hua Lu, Jian Guo Men Wai ')" },
                   { old_contact_id: 753,
                     new_contact_id: 4897,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission New Zealand', street address: '44 Hill Street'). new contact (title 'British High Commission New Zealand', street address: '44 Hill Street')" },
                   { old_contact_id: 759,
                     new_contact_id: 4767,
                     confidence: "exact match",
                     details: "old contact (title 'Head of Commercial Section and Defence and Security Sales', street address: 'British Embassy\r\nPloutarchou 1'). new contact (title 'Head of Commercial Section and Defence and Security Sales', street address: 'British Embassy\r\nPloutarchou 1')" },
                   { old_contact_id: 804,
                     new_contact_id: 4883,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy in the Kyrgyz Republic', street address: '21 Erkindik BoulevardOffice 404'). new contact (title 'British Embassy in the Kyrgyz Republic', street address: '21 Erkindik BoulevardOffice 404')" },
                   { old_contact_id: 817,
                     new_contact_id: 4936,
                     confidence: "exact match",
                     details: "old contact (title 'Department for Business and Trade Dubai', street address: 'PO Box 65'). new contact (title 'Department for Business and Trade Dubai', street address: 'PO Box 65')" },
                   { old_contact_id: 834,
                     new_contact_id: 4959,
                     confidence: "exact match",
                     details: "old contact (title 'Consular services (Jakarta)', street address: 'The British Embassy Jakarta\r\nJl Patra Kuningan Raya Blok L5-6\r\nJakarta'). new contact (title 'Consular services (Jakarta)', street address: 'The British Embassy Jakarta\r\nJl Patra Kuningan Raya Blok L5-6\r\nJakarta')" },
                   { old_contact_id: 835,
                     new_contact_id: 4960,
                     confidence: "exact match",
                     details: "old contact (title 'Consular services (Bali)', street address: 'British Consulate Bali\r\nJalan Tantular No 32\r\nRenon, Denpasar, Bali\r\nIndonesia, 80234'). new contact (title 'Consular services (Bali)', street address: 'British Consulate Bali\r\nJalan Tantular No 32\r\nRenon, Denpasar, Bali\r\nIndonesia, 80234')" },
                   { old_contact_id: 836,
                     new_contact_id: 4961,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Hanoi', street address: 'Central Building, 4th floor 31 Hai Ba Trung'). new contact (title 'British Embassy Hanoi', street address: 'Central Building, 4th floor 31 Hai Ba Trung')" },
                   { old_contact_id: 868,
                     new_contact_id: 4971,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Abuja', street address: 'Plot 1137Diplomatic DriveCentral Business District'). new contact (title 'British High Commission Abuja', street address: 'Plot 1137Diplomatic DriveCentral Business District')" },
                   { old_contact_id: 877,
                     new_contact_id: 4973,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Tokyo', street address: 'No 1 Ichiban-cho, Chiyoda-ku'). new contact (title 'British Embassy Tokyo', street address: 'No 1 Ichiban-cho, Chiyoda-ku')" },
                   { old_contact_id: 897,
                     new_contact_id: 4784,
                     confidence: "exact match",
                     details: "old contact (title 'British Consulate-General Hong Kong', street address: '1 Supreme Court Road'). new contact (title 'British Consulate-General Hong Kong', street address: '1 Supreme Court Road')" },
                   { old_contact_id: 959,
                     new_contact_id: 4989,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Dubai', street address: 'Al Seef Road\r\nBur Dubai\r\nNear to Dubai Creekside\r\nPO Box 65'). new contact (title 'British Embassy Dubai', street address: 'Al Seef RoadBur DubaiNear to Dubai CreeksidePO Box 65')" },
                   { old_contact_id: 1029,
                     new_contact_id: 4798,
                     confidence: "exact match",
                     details: "old contact (title 'Media enquiries', street address: '140 Sussex Drive'). new contact (title 'Media enquiries', street address: '140 Sussex Drive')" },
                   { old_contact_id: 1035,
                     new_contact_id: 4877,
                     confidence: "exact match",
                     details: "old contact (title 'The Consular Section of the British Consulate-General Guangzhou', street address: '22/F Guangzhou International Finance Centre, 5 Zhujiang Road West, Zhujiang New Town'). new contact (title 'The Consular Section of the British Consulate-General Guangzhou', street address: '22/F Guangzhou International Finance Centre, 5 Zhujiang Road West, Zhujiang New Town')" },
                   { old_contact_id: 1036,
                     new_contact_id: 4880,
                     confidence: "exact match",
                     details: "old contact (title 'The Consular Section of the British Consulate-General Shanghai', street address: '1702, British Centre, Garden Square, 968 West Beijing Road, Shanghai'). new contact (title 'The Consular Section of the British Consulate-General Shanghai', street address: '1702, British Centre, Garden Square, 968 West Beijing Road, Shanghai')" },
                   { old_contact_id: 1162,
                     new_contact_id: 5011,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Port-au-Prince', street address: 'Entre 73 et 75 Delmas'). new contact (title 'British Embassy Port-au-Prince', street address: 'Entre 73 et 75 Delmas')" },
                   { old_contact_id: 1174, new_contact_id: 8190, confidence: "exact match, manually mapped", details: "old contact (title 'British Embassy Asunci<C3><B3>n', street address: 'Edificio Citicenter, Piso 5Av. Mariscal L<C3><B3>pez y Cruz del Chaco'). new contact (title 'British Embassy Asunción', street address: 'Edificio Citicenter, Piso 5Av. Mariscal López y Cruz del Chaco')" },
                   { old_contact_id: 1365,
                     new_contact_id: 4427,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy', street address: 'Edificio Centro Col<C3><B3>n,\r\nPaseo Col<C3><B3>n and Streets 38 and 40 '). new contact (title 'British Embassy', street address: 'Edificio Centro Col<C3><B3>n, Paseo Col<C3><B3>n and Streets 38 and 40')" },
                   # Old contact: [1388, "Organisation", 26, "Companies House Scotland", 202, "1 Sibbald Walk"],
                   # { old_contact_id: 1388, new_contact_id: nil, confidence: "N/A", details: "N/A" },
                   { old_contact_id: 1503,
                     new_contact_id: 4793,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy San Salvador', street address: 'Torre Futura, 14th floor, Colonia Escal<C3><B3>n, San Salvador '). new contact (title 'British Embassy San Salvador', street address: 'Torre Futura, 14th floor, Colonia Escal<C3><B3>n, San Salvador ')" },
                   { old_contact_id: 2484,
                     new_contact_id: 4469,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Vienna - Consular Services', street address: 'Jauresgasse 12'). new contact (title 'British Embassy Vienna - Consular Services', street address: 'Jauresgasse 12')" },
                   { old_contact_id: 2666,
                     new_contact_id: 5031,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Bamako', street address: 'Cit<C3><A9> du Niger II'). new contact (title 'British Embassy Bamako', street address: 'Cit<C3><A9> du Niger II')" },
                   { old_contact_id: 2768,
                     new_contact_id: 5039,
                     confidence: "exact match",
                     details: "old contact (title 'British Vice Consulate Rhodes', street address: '29 Gr. Lambraki Street '). new contact (title 'British Vice Consulate Rhodes', street address: '29 Gr. Lambraki Street ')" },
                   { old_contact_id: 2772,
                     new_contact_id: 5043,
                     confidence: "exact match",
                     details: "old contact (title 'British Vice Consulate Corfu', street address: 'First floor, 18 Mantzarou Street'). new contact (title 'British Vice Consulate Corfu', street address: 'First floor, 18 Mantzarou Street')" },
                   { old_contact_id: 2773,
                     new_contact_id: 5044,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Vice Consulate Crete', street address: 'Candia Tower, 17 Thalita Street, Ag. Dimitrios SquareHeraklion'). new contact (title 'British Vice Consulate Crete', street address: 'Candia Tower, 17 Thalita Street, Ag. Dimitrios Square')" },
                   { old_contact_id: 2817, new_contact_id: 8194, confidence: "exact match - manually mapped", details: "old contact (title 'British Vice Consulate Portim<C3><A3>o', street address: 'Edificio A F<C3><A1>bricaAvenida Guanar<C3><A9>'). new contact (title: 'British Vice Consulate Portimão', street address: 'Edificio A FábricaAvenida Guanaré')" },
                   { old_contact_id: 2842,
                     new_contact_id: 5080,
                     confidence: "exact match",
                     details: "old contact (title 'Media enquiries, British Consulate-General Montreal', street address: '2000 avenue McGill College'). new contact (title 'Media enquiries, British Consulate-General Montreal', street address: '2000 avenue McGill College')" },
                   { old_contact_id: 2845,
                     new_contact_id: 5072,
                     confidence: "exact match",
                     details: "old contact (title 'Media enquiries, British Consulate-General Vancouver', street address: '1111 Melville Street, Suite 800'). new contact (title 'Media enquiries, British Consulate-General Vancouver', street address: '1111 Melville Street, Suite 800')" },
                   { old_contact_id: 2931,
                     new_contact_id: 4972,
                     confidence: "exact match",
                     details: "old contact (title 'British Deputy High Commission Lagos', street address: '11 Walter Carrington Crescent'). new contact (title 'British Deputy High Commission Lagos', street address: '11 Walter Carrington Crescent')" },
                   { old_contact_id: 3061,
                     new_contact_id: 4564,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British Embassy Berlin', street address: 'Wilhelmstra<C3><9F>e 70/71'). new contact (title 'British Embassy Berlin', street address: 'Wilhelmstra<C3><9F>e 70/71')" },
                   { old_contact_id: 3805,
                     new_contact_id: 5145,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Nouakchott', street address: 'Rue 42-163, B.P. 213, Tevragh Zeina'). new contact (title 'British Embassy Nouakchott', street address: 'Rue 42-163, B.P. 213, Tevragh Zeina')" },
                   { old_contact_id: 3810,
                     new_contact_id: 5144,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Maseru', street address: 'Maseru'). new contact (title 'British High Commission Maseru', street address: 'Maseru')" },
                   { old_contact_id: 3813,
                     new_contact_id: 5146,
                     confidence: "exact match",
                     details: "old contact (title 'British High Commission Mbabane', street address: 'Mbabane'). new contact (title 'British High Commission Mbabane', street address: 'Mbabane')" },
                   { old_contact_id: 3821,
                     new_contact_id: 5149,
                     confidence: "fuzzy match",
                     details: "old contact (title 'British High Commission Nassau', street address: 'Balmoral Corporate Centre3rd floorSandford Drive'). new contact (title 'British High Commission Nassau', street address: 'Balmoral Corporate Centre, 3rd floor Sandford Drive')" },
                   # Old contact: [4350, "Organisation", 6, "Further education outcomes", nil, ""]]
                   # { old_contact_id: 4350, new_contact_id: nil, confidence: "N/A", details: "N/A" }
                   { old_contact_id: 4026,
                     new_contact_id: 5160,
                     confidence: "exact match",
                     details: "old contact (title 'British Embassy Niamey', street address: 'BP:10 660'). new contact (title 'British Embassy Niamey', street address: 'BP:10 660')" }]

editions_with_missing_contacts = [193_459, 205_440, 209_950, 212_903, 220_054, 222_530, 248_500, 248_795, 250_074, 256_246, 275_673, 276_693, 280_213, 284_844, 292_431, 293_076, 297_184, 302_268, 304_289, 304_988, 304_989, 310_967, 328_948, 331_363, 334_924, 337_047, 338_303, 340_285, 342_923, 344_778, 358_893, 379_760, 399_612, 401_379, 406_308, 407_719, 413_895, 414_290, 443_950, 445_270, 459_024, 459_298, 461_699, 467_448, 473_516, 480_919, 499_056, 523_860, 556_418, 559_279, 561_604, 562_770, 568_121, 596_209, 598_925, 602_902, 610_300, 610_302, 610_329, 620_093, 624_295, 633_363, 653_437, 653_987, 658_665, 659_893, 661_279, 665_296, 672_092, 676_356, 677_949, 680_696, 685_428, 685_614, 685_817, 686_708, 689_169, 691_294, 691_431, 693_845, 697_087, 699_007, 699_258, 701_298, 702_532, 706_954, 707_220, 713_155, 714_080, 714_129, 717_610, 718_327, 721_094, 726_905, 732_904, 733_373, 743_001, 744_601, 747_043, 752_807, 754_707, 758_475, 760_497, 762_038, 762_265, 762_286, 765_886, 766_055, 773_629, 775_679, 779_844, 781_796, 784_784, 789_658, 793_373, 801_474, 802_111, 803_558, 805_869, 806_262, 809_436, 809_946, 811_087, 814_125, 817_818, 817_918, 819_894, 820_165, 821_424, 830_292, 830_306, 831_236, 833_462, 836_491, 836_850, 837_318, 837_322, 840_527, 840_832, 841_409, 846_074, 846_267, 847_454, 847_918, 848_298, 848_752, 848_798, 848_812, 848_817, 848_818, 848_837, 848_847, 848_850, 848_859, 848_861, 848_864, 848_918, 848_919, 848_929, 848_957, 848_974, 848_977, 848_979, 848_985, 850_348, 850_358, 850_367, 850_385, 850_392, 850_393, 850_396, 850_430, 850_432, 850_450, 850_690, 851_728, 852_064, 852_119, 852_650, 852_651, 852_908, 852_924, 852_983, 852_988, 852_993, 853_055, 853_061, 853_081, 853_115, 853_116, 853_200, 853_211, 853_241, 853_242, 853_732, 853_734, 853_742, 853_881, 854_066, 854_866, 855_121, 856_978, 861_029, 861_058, 861_064, 861_076, 861_476, 861_481, 861_973, 861_986, 861_991, 862_010, 862_011, 862_016, 862_027, 862_031, 862_585, 862_899, 862_985, 863_398, 863_402, 863_406, 864_417, 864_429, 865_531, 865_573, 865_594, 865_601, 865_683, 865_689, 865_696, 866_121, 866_125, 866_139, 866_141, 866_142, 866_169, 866_173, 866_178, 871_596, 875_647, 876_496, 876_587, 877_662, 878_326, 878_390, 903_451, 903_453, 904_370, 905_568, 907_939, 919_030, 938_517, 972_485, 980_793, 994_742, 1_022_657, 1_028_812, 1_084_334, 1_109_457, 1_198_954, 1_228_496, 1_261_499, 1_267_879, 1_268_265, 1_268_275, 1_268_339, 1_268_360, 1_269_113, 1_273_625, 1_273_881, 1_276_212, 1_371_319, 1_393_792, 1_393_794, 1_393_799, 1_393_802, 1_393_817, 1_393_820, 1_393_824, 1_393_825, 1_393_832, 1_393_833, 1_393_837, 1_393_840, 1_393_843, 1_393_846, 1_393_850, 1_393_854, 1_393_856, 1_393_857, 1_452_034, 1_507_008, 1_542_853, 1_558_629, 1_583_428, 1_607_150, 1_624_445, 1_633_779, 1_642_170]

html_attachments_with_missing_contacts = [
  3_814_149,
  4_471_654,
  4_509_802,
  4_509_815,
  4_563_055,
  4_603_729,
  4_603_753,
  4_603_759,
  4_609_350,
  4_631_844,
  4_631_960,
  4_631_962,
  4_631_963,
  4_639_768,
  4_640_194,
  4_645_147,
  4_648_949,
  4_648_992,
  4_774_867,
  4_774_902,
  4_779_790,
  4_826_939,
  4_826_975,
  4_827_010,
  4_877_018,
  4_978_412,
  4_982_369,
  4_982_370,
  4_982_372,
  5_006_356,
  5_019_429,
  5_019_434,
  5_057_631,
  5_057_660,
  5_105_217,
  5_137_735,
  5_138_896,
  5_168_102,
  5_168_332,
  5_168_455,
  5_172_348,
  5_195_011,
  5_248_965,
  5_271_504,
  5_271_838,
  5_279_583,
  5_289_268,
  5_291_893,
  5_303_811,
  5_336_484,
  5_370_628,
  5_417_672,
  5_417_690,
  5_441_948,
  5_569_103,
  5_569_485,
  5_569_499,
  5_588_459,
  5_630_640,
  5_644_034,
  5_694_453,
  5_701_121,
  5_905_020,
  5_905_021,
  5_905_022,
  5_905_023,
  6_461_343,
  6_472_444,
  6_507_475,
  6_546_290,
  6_546_291,
  6_550_214,
  6_591_296,
  6_702_884,
  6_721_612,
  6_761_678,
  6_834_882,
  6_840_928,
  6_843_302,
  6_843_358,
  6_843_495,
  6_904_820,
  6_907_793,
  6_910_792,
  6_927_220,
  6_927_223,
  6_982_563,
  7_092_348,
  7_102_754,
  7_108_647,
  7_108_648,
  7_108_661,
  7_111_845,
  7_121_815,
  7_124_312,
  7_129_316,
  7_137_019,
  7_140_183,
  7_140_191,
  7_153_455,
  7_213_060,
  7_217_387,
  7_275_543,
  7_283_348,
  7_322_745,
  7_353_751,
  7_356_479,
  7_378_151,
  7_407_859,
  7_425_760,
  7_425_946,
  7_450_735,
  7_450_738,
  7_619_097,
  7_722_830,
  7_750_336,
  7_750_483,
  7_750_528,
  7_750_542,
  7_750_645,
  7_750_648,
  7_750_661,
  7_750_664,
  7_750_683,
  7_750_694,
  7_750_709,
  7_750_710,
  7_750_722,
  7_750_723,
  7_750_735,
  7_750_751,
  7_751_706,
  7_751_720,
  7_751_725,
  7_751_730,
  7_751_735,
  7_751_760,
  7_752_288,
  7_752_292,
  7_752_301,
  7_752_402,
  7_752_409,
  7_754_814,
  7_754_823,
  7_754_831,
  7_754_861,
  7_754_862,
  7_754_885,
  7_755_519,
  7_755_588,
  7_755_859,
  7_755_861,
  7_755_866,
  7_756_431,
  7_756_510,
  7_756_514,
  7_758_037,
  7_758_293,
  7_759_039,
  7_759_107,
  7_759_132,
  7_759_137,
  7_759_140,
  7_759_146,
  7_759_168,
  7_759_174,
  7_759_176,
  7_759_177,
  7_759_182,
  7_782_309,
  7_801_537,
  7_804_899,
  7_841_119,
  7_843_698,
  7_885_285,
  7_903_854,
  7_907_370,
  7_937_171,
  7_944_011,
  7_971_095,
  8_031_548,
  8_034_194,
  8_045_946,
  8_053_475,
  8_076_608,
  8_100_856,
  8_128_049,
  8_157_503,
  8_187_327,
  8_201_624,
  8_201_637,
  8_201_643,
  8_201_656,
  8_201_657,
  8_207_036,
  8_207_037,
  8_225_300,
  8_261_293,
  8_261_319,
  8_261_324,
  8_261_327,
  8_261_335,
  8_261_341,
  8_261_342,
  8_266_238,
  8_266_239,
  8_266_240,
  8_266_241,
  8_270_124,
  8_279_205,
  8_296_131,
  8_307_944,
  8_315_541,
  8_323_130,
  8_338_895,
  8_342_472,
  8_342_473,
  8_342_474,
  8_342_475,
  8_396_197,
  8_396_198,
  8_396_199,
  8_396_200,
  8_404_057,
  8_412_653,
  8_437_143,
  8_437_912,
  8_437_913,
  8_437_914,
  8_444_884,
  8_447_849,
  8_447_850,
  8_461_911,
  8_463_953,
  8_483_768,
  8_496_387,
  8_496_504,
  8_500_489,
  8_510_960,
  8_510_995,
  8_516_197,
  8_522_420,
  8_559_936,
  8_559_940,
  8_567_582,
  8_577_882,
  8_578_217,
  8_578_445,
  8_598_868,
  8_601_319,
  8_627_262,
  8_642_486,
  8_657_454,
]

find_and_replace_mapping = contact_mapping.map do |contact|
  {
    "find" => "[Contact:#{contact[:old_contact_id]}]",
    "replace" => "[Contact:#{contact[:new_contact_id]}]",
  }
end

# # When testing locally, uncomment the lines below and swap `perform_async` calls for `new.perform`
# Rails.logger = Logger.new(STDOUT)
# Rails.logger.level = Logger::INFO
# ActiveRecord::Base.logger = nil # Temporarily silence SQL logging

editions_with_missing_contacts.each do |edition_id|
  FindAndReplaceWorker.perform_async(
    "edition_id" => edition_id,
    "replacements" => find_and_replace_mapping,
    "changenote" => "Automatically republished Edition with fixed Contact embed code",
    "log_prefix" => "[UpdateContactIds][edition] ",
  )
end

html_attachments_with_missing_contacts.each do |html_attachment_id|
  FindAndReplaceWorker.perform_async(
    "edition_id" => HtmlAttachment.find(html_attachment_id).attachable.document.latest_edition.id,
    "replacements" => find_and_replace_mapping,
    "changenote" => "Automatically republished Edition with fixed Contact embed code in HTML Attachment(s)",
    "log_prefix" => "[UpdateContactIds][html_attachment] ",
  )
end
